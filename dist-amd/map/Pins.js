(function(e,t){typeof define=="function"&&define.amd?define(["d3","topojson","./Layer","./Utility","../common/Palette","../common/Utility","css!./Pins"],t):e.map_Pins=t(e.d3,e.topojson,e.map_Layer,e.map_Utility,e.common_Palette,e.common_Utility)})(this,function(e,t,n,r,i,s){function o(){n.call(this)}return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype._class+=" map_Pins",o.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),o.prototype.publish("pinColor","#006ccc","html-color","Pin Color",null,{optional:!0}),o.prototype.publish("meshStrokeWidth",.25,"number","Stroke Width"),o.prototype.layerEnter=function(t,r,i){n.prototype.layerEnter.apply(this,arguments),this._pinsTransform=r,this._selection=new s.SimpleSelection(this._pinsTransform),this.pinsPaths=e.select(null)},o.prototype.layerUpdate=function(e){n.prototype.layerUpdate.apply(this,arguments),this.pinsPaths=this._pinsTransform.selectAll(".data").data(this.visible()?this.data():[],function(e){return e[0]});var t=this;this.pinsPaths.enter().append("path").attr("class","data").attr("d",function(e){return"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z M -2,-30"}).call(this._selection.enter.bind(this._selection)).on("click",function(e){t.click(t.rowToObj(e),"weight",t._selection.selected(this))}),this.pinsPaths.style("fill",function(e){return e[2]&&e[2].fillColor?e[2].fillColor:t.pinColor()}),this.pinsPaths.exit().remove()},o.prototype.layerZoomed=function(e){n.prototype.layerZoomed.apply(this,arguments),this.pinsPaths.style("display",function(t){var n=e.project(t[0],t[1]);return n?null:"none"}).attr("transform",function(t){var n=e.project(t[0],t[1]);return n||(n=[0,0]),"translate("+n[0]+", "+n[1]+")scale("+.5+")"}).attr("stroke-width","1.5px")},o.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+", "+n)},o});