(function(e,t){typeof define=="function"&&define.amd?define(["d3","./Choropleth","topojson","./countries"],t):e.map_ChoroplethCountries=t(e.d3,e.map_Choropleth,e.topojson,e.map_countries)})(this,function(e,t,n,r){function i(){t.call(this),this._dataMap={},this._dataMaxWeight=0,this._dataMinWeight=0,this.projection(this.worldProjection())}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_ChoroplethCountries",i.prototype.publish("worldProjection","mercator","set","Map Projection",["mercator","orthographic"],{tags:["Private"]}),i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(arguments.length){this._dataMap={},this._dataMinWeight=null,this._dataMaxWeight=null;var r=this;this.data().forEach(function(e){r._dataMap[e.country]=e.weight;if(!r._dataMinWeight||e.weight<r._dataMinWeight)r._dataMinWeight=e.weight;if(!r._dataMaxWeight||e.weight>r._dataMaxWeight)r._dataMaxWeight=e.weight})}return n},i.prototype.enter=function(i,s){t.prototype.enter.apply(this,arguments),s.classed("map_Choropleth",!0),this.projection(this.worldProjection());var o=this;this.lookup={};var u=n.feature(r.topology,r.topology.objects.countries).features.map(function(e){return e.category="Country",r.countryNames[e.id]&&(e.name=r.countryNames[e.id].name,o.lookup[e.name]=e),e}),a=this._svg.selectAll("path").data(u);this.choroPaths=a.enter().append("path").attr("d",this.d3Path).call(this._selection.enter.bind(this._selection)).on("click",function(e){if(o._dataMap[e.id]){var t=[e.id,o._dataMap[e.id],e.name];o.click(o.rowToObj(t),"weight",o._selection.selected(this))}}).on("dblclick",function(t){e.event.stopPropagation(),o.zoomToFit(o.active===this?null:this,750),o.active=this}).on("mouseover.tooltip",function(e){o._dataMap[e.id]&&o.tooltipShow([e.name,o._dataMap[e.id]],o.columns(),1)}).on("mouseout.tooltip",function(e){o.tooltipShow()}).on("mousemove.tooltip",function(e){o._dataMap[e.id]&&o.tooltipShow([e.name,o._dataMap[e.id]],o.columns(),1)}).attr("id",function(e){return e.id})},i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this.projection(this.worldProjection());var r=this;this.transition.apply(this.choroPaths).style("fill",function(e){var t=e.id,n=r._dataMap[t];return n===undefined?"url(#hash)":r._palette(n,r._dataMinWeight,r._dataMaxWeight)})},i});