(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/HTMLWidget","../api/IInput","css!./Input"],t):e.form_Input=t(e.d3,e.common_HTMLWidget,e.api_IInput)})(this,function(e,t,n){function r(){t.call(this),n.call(this),this._tag="div",this._inputElement=[]}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" form_Input",r.prototype.implements(n.prototype),r.prototype.publish("type","text","set","Input type",["html-color","number","checkbox","button","select","textarea","date","text","range","search","email","time","datetime"]),r.prototype.publish("selectOptions",[],"array","Array of options used to fill a dropdown list"),r.prototype.publish("low",null,"number","Minimum value for Range input"),r.prototype.publish("high",null,"number","Maximum value for Range input"),r.prototype.publish("step",null,"number","Step value for Range input"),r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this.createInput(n)},r.prototype.disable=function(e){this._inputElement.forEach(function(t,n){t.attr("disabled",e?"disabled":null)})},r.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this;this._inputElement.forEach(function(e){e.attr("name",i.name())});switch(this.type()){case"select":this.checkNodeName("SELECT",r),this.insertSelectOptions(this.selectOptions()),this._inputElement[0].property("value",this.value());break;case"textarea":this.checkNodeName("TEXTAREA",r),this._inputElement[0].property("value",this.value());break;case"button":this.checkNodeName("BUTTON",r),this._inputElement[0].text(this.value());break;case"radio":case"checkbox":this.checkNodeName("INPUT",r),this._inputElement.forEach(function(e,t){e.property("value",i.selectOptions()[t]),i.value().indexOf(i.selectOptions()[t])!==-1&&i.value()!=="false"?e.property("checked",!0):e.property("checked",!1)});break;case"html-color":this.checkNodeName("INPUT",r),this._inputElement[0].attr("type","text"),this._inputElement[1].attr("type","color"),this._inputElement[0].property("value",this.value()),this._inputElement[1].property("value",e.rgb(this.value()).toString());break;case"range":this.checkNodeName("INPUT",r),this._inputElement[0].attr("type","range"),this._inputElement[0].property("value",this.value()),this._inputElement[0].attr("min",this.low()),this._inputElement[0].attr("max",this.high()),this._inputElement[0].attr("step",this.step()),this._inputElement[1].attr("type","number"),this._inputElement[1].property("value",this.value()),this._inputElement[1].attr("min",this.low()),this._inputElement[1].attr("max",this.high()),this._inputElement[1].attr("step",this.step());break;default:this.checkNodeName("INPUT",r),this._inputElement[0].attr("type",this.type()),this._inputElement[0].property("value",this.value())}},r.prototype.createInput=function(t){var n=this;switch(this.type()){case"select":this._inputElement[0]=t.append("select");break;case"textarea":this._inputElement[0]=t.append("textarea");break;case"button":this._inputElement[0]=t.append("button");break;case"radio":case"checkbox":var r=t.append("ul");this.selectOptions().length||this.selectOptions().push(""),this.selectOptions().forEach(function(e,t){n._inputElement[t]=r.append("li").append("input").attr("type",n.type()),n._inputElement[t].node().insertAdjacentHTML("afterend","<text>"+e+"</text>")});break;case"html-color":this._inputElement[0]=t.append("input").attr("type","text"),this._inputElement[0].classed("color-text",!0),this._inputElement[1]=t.append("input").attr("type","color");break;case"range":this._inputElement[0]=t.append("input").attr("type","range"),this._inputElement[1]=t.append("input").attr("type","number");break;default:this._inputElement[0]=t.append("input").attr("type",this.type())}this._inputElement.forEach(function(e,t){e.on("click",function(e){e.click(e)})}),this._inputElement.forEach(function(e,t){e.on("blur",function(e){e.blur(e)})}),this._inputElement.forEach(function(t,r){t.on("change",function(i){switch(n.type()){case"checkbox":var s=[];n._inputElement.forEach(function(e,t){e.property("checked")&&s.push(e.property("value"))}),n.value(s);break;case"range":case"html-color":r===0?(n._inputElement[1].property("value",e.rgb(n._inputElement[0].property("value")).toString()),n.value(n._inputElement[0].property("value"))):(n._inputElement[0].property("value",n._inputElement[1].property("value")),n.value(e.rgb(n._inputElement[1].property("value")).toString()));break;default:n.value([t.property("value")])}i.change(i)})})},r.prototype.insertSelectOptions=function(e){var t="";e.length>0?e.forEach(function(e){var n=e instanceof Array?e[0]:e,r=e instanceof Array?e[1]?e[1]:e[0]:e;t+="<option value='"+n+"'>"+r+"</option>"}):t+="<option>selectOptions not set</option>",this._inputElement[0].html(t)},r.prototype.checkNodeName=function(e,t){var n=this._inputElement.some(function(t){if(t.node().nodeName!==e)return!0});n&&(this._inputElement.forEach(function(e){e.node().remove()}),this.createInput(t))},r.prototype.resetValue=function(e){e.type()==="checkbox"?e.value(e._inputElement.node().checked):e.value(e._inputElement.node().value)},r});